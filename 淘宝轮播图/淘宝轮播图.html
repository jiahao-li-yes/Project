<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>淘宝轮播图</title>
    <link rel="stylesheet" href="%E6%B7%98%E5%AE%9D%E8%BD%AE%E6%92%AD%E5%9B%BE.css">
</head>
<body>
    <div class="container">
        <div class="main">           
            <img src="images/5.jpg" alt="">
            <img src="images/1.jpg" alt="">
            <img src="images/2.jpg" alt="">
            <img src="images/3.jpg" alt="">
            <img src="images/4.jpg" alt="">
            <img src="images/5.jpg" alt="">
            <img src="images/1.jpg" alt="">
        </div>       
    
    <ul class="list">
        <li class="active"></li>
        <li></li>
        <li></li>
        <li></li>
        <li></li>
    </ul>
    <a href="javascript:;" class="btn" id="prev"><</a>
    <a href="javascript:;" class="btn" id="next">></a>
    </div>
</body>

    <script>
        var  oPrev = document.getElementById('prev'),
             oNext = document.getElementById('next'),
             oMain = document.getElementsByClassName('main')[0],
             oList = document.getElementsByClassName('list')[0],
             oLi = document.getElementsByTagName('li'),
             oContainer = document.getElementsByClassName('container')[0];
        
        
        var  timer, timer2,
             oLilenght = oLi.length,
             index = 0,
             flag = true;
        
        
        
        function moveImg(dis){
                flag = false;
            var time = 400;//每次轮播需要的时间
            var eachTime =20;//每一小次移动的时间
            var eachDis = dis/(time/eachTime);
            var newLeft = oMain.offsetLeft + dis;
            
            console.log(oList);
            
            function eachMove(){            
                if(dis>0 && oMain.offsetLeft < newLeft || dis < 0 && oMain.offsetLeft > newLeft){
                    oMain.style.left = oMain.offsetLeft + eachDis + 'px';
                    // console.log(oMain.offsetLeft);
                }
                else{
                    clearInterval(timer);
                    oMain.style.left = newLeft + 'px';
                    if(newLeft == -3120){
                        oMain.style.left = -520 + 'px';
                    }
                    if(newLeft == 0){
                        oMain.style.left = -2600 + 'px';
                    }  
                    flag = true;
                }          
            }
            timer = setInterval(eachMove,eachTime)   
 
        }
        
        
        oPrev.onclick = function(){
            if(flag == false) return;//运行到return返回，下面代码不执行
            moveImg(520);
            if(index == 0){
                index = 4;
            }
            else{
                index--;
            }
            oLiStyle();
        }
        
        oNext.onclick = function(){
            if(flag == false) return;
            moveImg(-520);
            if(index == 4){
                index = 0;
            }else{
                index++;
            }
            oLiStyle();
        }
        
        function oLiStyle(){
            oList.getElementsByClassName('active')[0].className = "";
            oLi[index].className = 'active';
        }
        
        for(var i = 0; i< oLilenght; i++){
            (function(j){
               oLi[j].onclick = function(){
                   var offset = (j - index) * -520;//index还没有定义成j，所以index就是上一个的值
                   index = j; 
//                   console.log(j);
                   oLiStyle();
                   moveImg(offset);
               }
               })(i);
            
            }
        
        timer2 = setInterval(oNext.onclick,2000);
        
        oContainer.onmouseover = function(){
            clearInterval(timer2);
        }
        
        oContainer.onmouseout = function(){
            timer2 = setInterval(oNext.onclick,2000);
        }
    </script>
</html>






